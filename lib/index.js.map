{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\nimport React, {Component} from 'react';\nimport { PropTypes, ValueManager, loader, injector} from 'Subschema';\nimport ReactDOM from 'react-dom';\nimport TestUtils from 'react-addons-test-utils';\nimport expect from 'expect';\n\nvar Simulate = TestUtils.Simulate;\n\nfunction prettyLog(result) {\n    console.log(JSON.stringify(result, null, '\\t'));\n}\n\nfunction into(node, debug) {\n    if (debug === true) {\n        debug = document.createElement('div');\n        document.body.appendChild(debug);\n        return ReactDOM.render(node, debug);\n    }\n    return TestUtils.renderIntoDocument(node);\n}\n\nfunction notByType(node, type, description) {\n    var ret = byTypes(node, type);\n    expect(ret[0]).toNotExist(description);\n}\nfunction expected(nodes, length) {\n    if (length === void(0)) {\n        return nodes;\n    }\n    if (nodes.length !== length) {\n        throw new Error(`Found ${node.length} nodes expected ${length}`);\n    }\n    return nodes;\n}\nfunction byTypes(node, type, length) {\n    return expected(TestUtils.scryRenderedComponentsWithType(node, type), length);\n}\nfunction byType(node, type) {\n    return TestUtils.findRenderedComponentWithType(node, type);\n}\n\nfunction byTag(node, tag) {\n    return TestUtils.findRenderedDOMComponentWithTag(node, tag);\n}\n\nfunction byTags(node, tag, length) {\n    return expected(TestUtils.scryRenderedDOMComponentsWithTag(node, tag), length);\n}\nfunction onlyOne(node) {\n    if (node.length != 1) {\n        throw new Error(`Found ${node.length} nodes expected 1`)\n    }\n    return node[0];\n}\nfunction byName(root, name) {\n    return onlyOne(TestUtils.findAllInRenderedTree(root, function (inst) {\n        if (!TestUtils.isDOMComponent(inst)) {\n            return false;\n        }\n        var inode = findNode(inst);\n        return inode.name === name;\n    }));\n}\n\n\nfunction filterProp(node, property, value) {\n    node = Array.isArray(node) ? node : [node];\n    return node.filter((n)=> {\n        var props = (n instanceof Element) ? n.attributes : n.props;\n        if (property in props) {\n            if (value === null) return true;\n\n            return props[property] === value;\n        }\n        return false;\n    })\n}\nfunction byId(node, id) {\n    var all = TestUtils.findAllInRenderedTree(node, function (inst) {\n        if (!TestUtils.isDOMComponent(inst)) {\n            return false;\n        }\n        var inode = findNode(inst);\n        return inode.id === id;\n    });\n    return onlyOne(all);\n}\n\nfunction click(node) {\n    Simulate.click(findNode(node));\n    return node;\n}\n\nfunction change(node, value) {\n    Simulate.change(findNode(node), {target: {value}});\n    return node;\n}\nfunction check(node, checked, value) {\n    Simulate.change(findNode(node), {target: {checked, value}});\n    return node;\n}\nfunction blur(node) {\n    Simulate.blur(findNode(node));\n    return node;\n}\n\nfunction focus(node) {\n    Simulate.focus(findNode(node));\n    return node;\n}\n\nfunction byComponent(node, comp) {\n    return onlyOne(TestUtils.scryRenderedComponentsWithType(asNode(node), comp));\n}\n\nfunction byComponents(node, comp, length) {\n    return expected(TestUtils.scryRenderedComponentsWithType(asNode(node), comp), length);\n}\nfunction byClass(node, className) {\n    return TestUtils.scryRenderedDOMComponentsWithClass(asNode(node), className);\n}\nfunction asNode(node) {\n    if (Array.isArray(node)) {\n        return onlyOne(node);\n    }\n    return node;\n}\nfunction findNode(n) {\n    return ReactDOM.findDOMNode(asNode(n));\n}\nfunction defChildContext() {\n    return {\n        valueManager: ValueManager(),\n        loader: loader,\n        injector: injector\n    };\n}\nfunction context(childContext = defChildContext, childContextTypes = {\n    valueManager: PropTypes.valueManager,\n    loader: PropTypes.loader,\n    injector: PropTypes.injector\n}) {\n\n    const getChildContext = typeof childContext === 'function' ? childContext : function () {\n        return childContext;\n    };\n\n    class Context extends Component {\n        static childContextTypes = childContextTypes;\n\n        getChildContext = getChildContext;\n\n        render() {\n            return this.props.children;\n        }\n    }\n    return Context;\n}\nfunction intoWithContext(child, ctx, debug, contextTypes) {\n    var Context = context(ctx, contextTypes);\n    return byType(into(<Context>{child}</Context>, debug), child.type);\n}\n\n\nfunction select(composit, index) {\n    var node = findNode(composit);\n    var multiple = node.multiple;\n\n    var options = byTags(composit, 'option')\n    expect(options[index]).toExist(`${index} should exist`);\n    if (!multiple) {\n        options.forEach((option, idx)=> {\n            option.selected = (idx === index);\n        })\n    } else {\n        options[index].selected = !options[index].selected;\n    }\n\n    Simulate.change(node, {\n        target: {\n            options,\n            value: multiple ? options.map((o)=>o.value) : options[index].value\n        }\n    });\n    return node;\n}\nclass StateWrapper extends Component {\n    render() {\n        return React.cloneElement(this.props.children, this.state);\n    }\n}\n\nfunction intoWithState(child, state, debug) {\n    var s = into(<StateWrapper>{child}</StateWrapper>, debug);\n    if (state != null) s.setState(state);\n    var schild = byType(s, child.type);\n    return {\n        state: s,\n        child: schild\n    }\n}\n\nexport {\n    React,\n    ReactDOM,\n    TestUtils,\n    Simulate,\n    intoWithState,\n    into,\n    context,\n    intoWithContext,\n    prettyLog,\n    findNode,\n    expect,\n    byId,\n    byName,\n    byTags,\n    byTag,\n    byType,\n    byTypes,\n    notByType,\n    filterProp,\n    byClass,\n    byComponent,\n    byComponents,\n    //trigger events\n    select,\n    click,\n    change,\n    check,\n    blur,\n    focus,\n    expected\n}"]}