{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\nimport React, {Component} from 'react';\nimport { PropTypes, ValueManager, loader, injector} from 'Subschema';\nimport ReactDOM from 'react-dom';\nimport TestUtils from 'react-addons-test-utils';\nimport expect from 'expect';\n\nvar Simulate = TestUtils.Simulate;\n\nfunction prettyLog(result) {\n    console.log(JSON.stringify(result, null, '\\t'));\n}\n\nfunction into(node, debug) {\n    if (debug === true) {\n        debug = document.createElement('div');\n        document.body.appendChild(debug);\n        return ReactDOM.render(node, debug);\n    }\n    return TestUtils.renderIntoDocument(node);\n}\n\nfunction notByType(node, type, description) {\n    var ret = byTypes(node, type);\n    expect(ret[0]).toNotExist(description);\n}\nfunction expected(nodes, length) {\n    if (length === void(0)) {\n        return nodes;\n    }\n    if (nodes.length !== length) {\n        throw new Error(`Found ${node.length} nodes expected ${length}`);\n    }\n    return nodes;\n}\nfunction byTypes(node, type, length) {\n    return expected(TestUtils.scryRenderedComponentsWithType(node, type), length);\n}\nfunction byType(node, type) {\n    return TestUtils.findRenderedComponentWithType(node, type);\n}\n\nfunction byTag(node, tag) {\n    return TestUtils.findRenderedDOMComponentWithTag(node, tag);\n}\n\nfunction byTags(node, tag, length) {\n    return expected(TestUtils.scryRenderedDOMComponentsWithTag(node, tag), length);\n}\nfunction onlyOne(node) {\n    if (node.length != 1) {\n        throw new Error(`Found ${node.length} nodes expected 1`)\n    }\n    return node[0];\n}\nfunction byName(root, name) {\n    return onlyOne(TestUtils.findAllInRenderedTree(root, function (inst) {\n        if (!TestUtils.isDOMComponent(inst)) {\n            return false;\n        }\n        var inode = findNode(inst);\n        return inode.name === name;\n    }));\n}\n\n\nfunction filterProp(node, property, value) {\n    node = Array.isArray(node) ? node : [node];\n    return node.filter((n)=> {\n        var props = (n instanceof Element) ? n.attributes : n.props;\n        if (property in props) {\n            if (value === null) return true;\n\n            return props[property] === value;\n        }\n        return false;\n    })\n}\nfunction byId(node, id) {\n    var all = TestUtils.findAllInRenderedTree(node, function (inst) {\n        if (!TestUtils.isDOMComponent(inst)) {\n            return false;\n        }\n        var inode = findNode(inst);\n        return inode.id === id;\n    });\n    return onlyOne(all);\n}\n\nfunction click(node) {\n    Simulate.click(findNode(node));\n    return node;\n}\n\nfunction change(node, value) {\n    Simulate.change(findNode(node), {target: {value}});\n    return node;\n}\nfunction check(node, checked, value) {\n    Simulate.change(findNode(node), {target: {checked, value}});\n    return node;\n}\nfunction blur(node) {\n    Simulate.blur(findNode(node));\n    return node;\n}\n\nfunction focus(node) {\n    Simulate.focus(findNode(node));\n    return node;\n}\n\nfunction byComponent(node, comp) {\n    return onlyOne(TestUtils.scryRenderedComponentsWithType(asNode(node), comp));\n}\n\nfunction byComponents(node, comp, length) {\n    return expected(TestUtils.scryRenderedComponentsWithType(asNode(node), comp), length);\n}\nfunction byClass(node, className) {\n    return TestUtils.scryRenderedDOMComponentsWithClass(asNode(node), className);\n}\nfunction asNode(node) {\n    if (Array.isArray(node)) {\n        return onlyOne(node);\n    }\n    return node;\n}\nfunction findNode(n) {\n    return ReactDOM.findDOMNode(asNode(n));\n}\nfunction defChildContext() {\n    return {\n        valueManager: ValueManager(),\n        loader: loader,\n        injector: injector\n    };\n}\nfunction context(childContext = defChildContext, childContextTypes = {\n    valueManager: PropTypes.valueManager,\n    loader: PropTypes.loader,\n    injector: PropTypes.injector\n}) {\n\n    const getChildContext = typeof childContext === 'function' ? childContext : function () {\n        return childContext;\n    };\n\n    class Context extends Component {\n        static childContextTypes = childContextTypes;\n\n        getChildContext = getChildContext;\n\n        render() {\n            return this.props.children;\n        }\n    }\n    return Context;\n}\nfunction intoWithContext(child, ctx, debug, contextTypes) {\n    var Context = context(ctx, contextTypes);\n    return byType(into(<Context>{child}</Context>, debug), child.type);\n}\n\n\nfunction select(composit, index) {\n    var node = findNode(composit);\n    var multiple = node.multiple;\n\n    var options = byTags(composit, 'option')\n    expect(options[index]).toExist(`${index} should exist`);\n    if (!multiple) {\n        options.forEach((option, idx)=> {\n            option.selected = (idx === index);\n        })\n    } else {\n        options[index].selected = !options[index].selected;\n    }\n\n    Simulate.change(node, {\n        target: {\n            options,\n            value: multiple ? options.map((o)=>o.value) : options[index].value\n        }\n    });\n    return node;\n}\nclass StateWrapper extends Component {\n    render() {\n        return React.cloneElement(this.props.children, this.state);\n    }\n}\n\nfunction intoWithState(child, state, debug) {\n    var s = into(<StateWrapper>{child}</StateWrapper>, debug);\n    if (state != null) s.setState(state);\n    var schild = byType(s, child.type);\n    return {\n        state: s,\n        child: schild\n    }\n}\n\nexport {\n    React,\n    ReactDOM,\n    TestUtils,\n    Simulate,\n    intoWithState,\n    into,\n    context,\n    intoWithContext,\n    prettyLog,\n    findNode,\n    expect,\n    byId,\n    byName,\n    byTags,\n    byTag,\n    byType,\n    byTypes,\n    notByType,\n    filterProp,\n    byClass,\n    byComponent,\n    byComponents,\n    //trigger events\n    select,\n    click,\n    change,\n    check,\n    blur,\n    focus,\n    expected\n}"]}