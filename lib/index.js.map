{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\nimport React, {Component} from 'react';\nimport { PropTypes, ValueManager, loader, injector} from 'Subschema';\nimport ReactDOM from 'react-dom';\nimport TestUtils from 'react-addons-test-utils';\nimport expect from 'expect';\n\nvar Simulate = TestUtils.Simulate;\n\nfunction prettyLog(result) {\n    console.log(JSON.stringify(result, null, '\\t'));\n}\n\nfunction into(node, debug) {\n    if (debug === true) {\n        debug = document.createElement('div');\n        document.body.appendChild(debug);\n        return ReactDOM.render(node, debug);\n    }\n    return TestUtils.renderIntoDocument(node);\n}\n\nfunction notByType(node, type, description) {\n    var ret = byTypes(node, type);\n    expect(ret[0]).toNotExist(description);\n}\nfunction expected(nodes, length) {\n    if (length === void(0)) {\n        return nodes;\n    }\n    if (nodes.length !== length) {\n        throw new Error(`Found ${node.length} nodes expected ${length}`);\n    }\n    return nodes;\n}\nfunction byTypes(node, type, length) {\n    return expected(TestUtils.scryRenderedComponentsWithType(node, type), length);\n}\nfunction byType(node, type) {\n    return TestUtils.findRenderedComponentWithType(node, type);\n}\n\nfunction byTag(node, tag) {\n    return TestUtils.findRenderedDOMComponentWithTag(node, tag);\n}\n\nfunction byTags(node, tag, length) {\n    return expected(TestUtils.scryRenderedDOMComponentsWithTag(node, tag), length);\n}\nfunction onlyOne(node) {\n    if (node.length != 1) {\n        throw new Error(`Found ${node.length} nodes expected 1`)\n    }\n    return node[0];\n}\nfunction byName(root, name) {\n    return onlyOne(TestUtils.findAllInRenderedTree(root, function (inst) {\n        if (!TestUtils.isDOMComponent(inst)) {\n            return false;\n        }\n        var inode = findNode(inst);\n        return inode.name === name;\n    }));\n}\n\n\nfunction filterProp(node, property, value) {\n    node = Array.isArray(node) ? node : [node];\n    return node.filter((n)=> {\n        var props = (n instanceof Element) ? n.attributes : n.props;\n        if (property in props) {\n            if (value === null) return true;\n\n            return props[property] === value;\n        }\n        return false;\n    })\n}\nfunction byId(node, id) {\n    var all = TestUtils.findAllInRenderedTree(node, function (inst) {\n        if (!TestUtils.isDOMComponent(inst)) {\n            return false;\n        }\n        var inode = findNode(inst);\n        return inode.id === id;\n    });\n    return onlyOne(all);\n}\n\nfunction click(node) {\n    Simulate.click(findNode(node));\n    return node;\n}\n\nfunction change(node, value) {\n    Simulate.change(findNode(node), {target: {value}});\n    return node;\n}\nfunction check(node, checked, value) {\n    Simulate.change(findNode(node), {target: {checked, value}});\n    return node;\n}\nfunction blur(node) {\n    Simulate.blur(findNode(node));\n    return node;\n}\n\nfunction focus(node) {\n    Simulate.focus(findNode(node));\n    return node;\n}\n\nfunction byComponent(node, comp) {\n    return onlyOne(TestUtils.scryRenderedComponentsWithType(asNode(node), comp));\n}\n\nfunction byComponents(node, comp, length) {\n    return expected(TestUtils.scryRenderedComponentsWithType(asNode(node), comp), length);\n}\nfunction byClass(node, className) {\n    return TestUtils.scryRenderedDOMComponentsWithClass(asNode(node), className);\n}\nfunction asNode(node) {\n    if (Array.isArray(node)) {\n        return onlyOne(node);\n    }\n    return node;\n}\nfunction findNode(n) {\n    return ReactDOM.findDOMNode(asNode(n));\n}\nfunction defChildContext() {\n    return {\n        valueManager: ValueManager(),\n        loader: loader,\n        injector: injector\n    };\n}\nfunction context(childContext = defChildContext, childContextTypes = {\n    valueManager: PropTypes.valueManager,\n    loader: PropTypes.loader,\n    injector: PropTypes.injector\n}) {\n\n    const getChildContext = typeof childContext === 'function' ? childContext : function () {\n        return childContext;\n    };\n\n    class Context extends Component {\n        render() {\n            return this.props.children;\n        }\n    }\n    Context.prototype.getChildContext = getChildContext;\n    Context.childContextTypes = childContextTypes\n    return Context;\n}\nfunction intoWithContext(child, ctx, debug, contextTypes) {\n    var Context = context(ctx, contextTypes);\n    return byType(into(<Context>{child}</Context>, debug), child.type);\n}\n\n\nfunction select(composit, index) {\n    var node = findNode(composit);\n    var multiple = node.multiple;\n\n    var options = byTags(composit, 'option')\n    expect(options[index]).toExist(`${index} should exist`);\n    if (!multiple) {\n        options.forEach((option, idx)=> {\n            option.selected = (idx === index);\n        })\n    } else {\n        options[index].selected = !options[index].selected;\n    }\n\n    Simulate.change(node, {\n        target: {\n            options,\n            value: multiple ? options.map((o)=>o.value) : options[index].value\n        }\n    });\n    return node;\n}\nclass StateWrapper extends Component {\n    render() {\n        return React.cloneElement(this.props.children, this.state);\n    }\n}\n\nfunction intoWithState(child, state, debug) {\n    var s = into(<StateWrapper>{child}</StateWrapper>, debug);\n    if (state != null) s.setState(state);\n    var schild = byType(s, child.type);\n    return {\n        state: s,\n        child: schild\n    }\n}\n\nexport {\n    React,\n    ReactDOM,\n    TestUtils,\n    Simulate,\n    intoWithState,\n    into,\n    context,\n    intoWithContext,\n    prettyLog,\n    findNode,\n    expect,\n    byId,\n    byName,\n    byTags,\n    byTag,\n    byType,\n    byTypes,\n    notByType,\n    filterProp,\n    byClass,\n    byComponent,\n    byComponents,\n    //trigger events\n    select,\n    click,\n    change,\n    check,\n    blur,\n    focus,\n    expected\n}"]}